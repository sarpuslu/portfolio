{"ast":null,"code":"var _jsxFileName = \"/Users/sarp.usulu/Desktop/web_development/react_trades_exercise/src/App.tsx\";\nimport React, { Component } from \"react\";\nimport \"./App.css\";\nimport _ from \"lodash\";\nimport PieChart from \"./highcharts/highcharts_pie\";\nimport SymbolGrid from \"./agGrid/agGrid\";\nimport NewTradeForm from \"./new_trade_form/new_trade_form\";\nimport { Route, BrowserRouter } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { ClassicSpinner } from \"react-spinners-kit\";\n\nclass App extends Component {\n  // state = {\n  //   trades_data: null,\n  //   portfolio_sorted: null,\n  //   symbols: null,\n  //   percentages: null,\n  //   amounts: null,\n  //   quantities: null\n  // };\n  // TODO: THIS INITIALIZATION IS A TEMPORARY SOLUTION TO STATE INITIALIZATION PROBLEM\n  constructor(props) {\n    super(props);\n    this.state = void 0;\n    this.state = {\n      trades_data: [{\n        symbol: \"GOOGL\",\n        qty: 621,\n        price: 25.15590870261679,\n        time: \"3:06:07 AM\"\n      }],\n      portfolio_sorted: [{\n        symbol: \"GOOGL\",\n        qty: 621,\n        price: 25.15590870261679,\n        time: \"3:06:07 AM\"\n      }],\n      symbols: [],\n      percentages: [],\n      amounts: [],\n      quantities: []\n    };\n  }\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  fetchData() {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Cache-Control': 'no-cache'\n      }\n    };\n    axios.get(\"http://localhost:5000/api/trades\", config).then(response => {\n      //fetch raw data which has symbol, percentage, quantity and price fields\n      let trades_data = response.data; //add the amount field for each trade\n\n      for (let trade of trades_data) {\n        trade.amount = trade.qty * trade.price;\n      }\n\n      let portfolio_summed;\n      portfolio_summed = _(trades_data).groupBy(\"symbol\").map((objs, key) => {\n        return {\n          symbol: key,\n          qty: _.sumBy(objs, \"qty\"),\n          amount: _.sumBy(objs, \"amount\")\n        };\n      }).value(); //calculate the total size of the portfolio in dollars\n\n      let total_amount = 0;\n\n      for (const elem of portfolio_summed) {\n        total_amount = total_amount + elem.amount;\n      } //calculate the percentage of each element in the portfolio\n\n\n      for (let elem of portfolio_summed) {\n        elem.percentage = elem.amount / total_amount * 100;\n      } //sort the portfolio-wise values first by percentage then by the symbol name alphabetically\n\n\n      let portfolio_sorted = _.orderBy(portfolio_summed, [\"percentage\", \"symbol\"], [\"desc\", \"desc\"]); //get arrays of values to be sent as props to highcharts\n\n\n      let symbols = [...portfolio_sorted.map(x => x.symbol)];\n      let percentages = [...portfolio_sorted.map(x => x.percentage)];\n      let amounts = [...portfolio_sorted.map(x => x.amount)];\n      let quantities = [...portfolio_sorted.map(x => x.qty)]; // console.log(\"data fetcher called!\");\n      //update the state with raw incoming data and arrays describing the portfolio\n\n      this.setState({\n        trades_data: trades_data,\n        symbols: symbols,\n        percentages: percentages,\n        amounts: amounts,\n        quantities: quantities\n      });\n    });\n  }\n\n  render() {\n    // TODO: THIS CONIDITION CHECK IS A TEMPORARY SOLUTION TO STATE INITIALIZATION PROBLEM\n    if (this.state.trades_data.length !== 1) {\n      return React.createElement(BrowserRouter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        id: \"brand_text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, \"PORTFOLIO\")), React.createElement(Route, {\n        path: \"/\",\n        exact: true,\n        render: routeProps => React.createElement(PieChart, Object.assign({}, routeProps, {\n          symbols: this.state.symbols,\n          percentages: this.state.percentages,\n          amounts: this.state.amounts,\n          quantities: this.state.quantities,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/addTrade\",\n        exact: true,\n        render: routeProps => React.createElement(NewTradeForm, Object.assign({}, routeProps, {\n          symbols: this.state.symbols,\n          dataFetcher: this.fetchData,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/detail/:symbol\",\n        exact: true,\n        render: routeProps => React.createElement(SymbolGrid, Object.assign({}, routeProps, {\n          trades: this.state.trades_data,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      })));\n    } else {\n      return React.createElement(\"div\", {\n        className: \"spinner\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(ClassicSpinner, {\n        size: 40,\n        color: \"#686769\",\n        loading: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }));\n    }\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/sarp.usulu/Desktop/web_development/react_trades_exercise/src/App.tsx"],"names":["React","Component","_","PieChart","SymbolGrid","NewTradeForm","Route","BrowserRouter","axios","ClassicSpinner","App","constructor","props","state","trades_data","symbol","qty","price","time","portfolio_sorted","symbols","percentages","amounts","quantities","componentDidMount","fetchData","config","headers","get","then","response","data","trade","amount","portfolio_summed","groupBy","map","objs","key","sumBy","value","total_amount","elem","percentage","orderBy","x","setState","render","length","routeProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./App.css\";\nimport _ from \"lodash\";\nimport PieChart from \"./highcharts/highcharts_pie\";\nimport SymbolGrid from \"./agGrid/agGrid\";\nimport NewTradeForm from \"./new_trade_form/new_trade_form\";\nimport { Route, BrowserRouter } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { ClassicSpinner } from \"react-spinners-kit\";\nimport { RouteComponentProps } from 'react-router-dom';\n\n\n\n\ninterface IState {\n  trades_data: {symbol: string, qty: number, price:number, time: string}[],\n  portfolio_sorted: {symbol: string, qty: number, price:number, time:string, amount?:number, percentage?:number}[],\n  symbols: string[],\n  percentages: number[],\n  amounts: number[],\n  quantities: number[] \n}\n\nclass App extends Component<RouteComponentProps, IState> {\n  // state = {\n  //   trades_data: null,\n  //   portfolio_sorted: null,\n  //   symbols: null,\n  //   percentages: null,\n  //   amounts: null,\n  //   quantities: null\n  // };\n\n\n  public state: IState;\n\n  // TODO: THIS INITIALIZATION IS A TEMPORARY SOLUTION TO STATE INITIALIZATION PROBLEM\n  constructor(props:RouteComponentProps){\n    super(props);\n      this.state = {\n        trades_data: [{\n          symbol: \"GOOGL\",\n          qty: 621,\n          price: 25.15590870261679,\n          time: \"3:06:07 AM\"\n        }],\n        portfolio_sorted: [{\n          symbol: \"GOOGL\",\n          qty: 621,\n          price: 25.15590870261679,\n          time: \"3:06:07 AM\"\n        }],\n        symbols: [],\n        percentages: [],\n        amounts: [],\n        quantities: []\n      }\n  }\n    \n  componentDidMount() {\n    this.fetchData();\n  }\n\n  fetchData(){\n    const config = { headers: {'Content-Type': 'application/json','Cache-Control' : 'no-cache'}};\n\n    axios.get(\"http://localhost:5000/api/trades\", config).then(response => {\n      //fetch raw data which has symbol, percentage, quantity and price fields\n      let trades_data:IState[\"portfolio_sorted\"] = response.data;\n      //add the amount field for each trade\n      for (let trade of trades_data) {\n        trade.amount = trade.qty * trade.price;\n      }\n\n\n      let portfolio_summed: {symbol: string, qty: number, amount:number, percentage?:number}[];\n      portfolio_summed = _(trades_data)\n        .groupBy(\"symbol\")\n        .map((objs, key) => {\n          return {\n            symbol: key,\n            qty: _.sumBy(objs, \"qty\"),\n            amount: _.sumBy(objs, \"amount\")\n          };\n        })\n        .value();\n\n      //calculate the total size of the portfolio in dollars\n      let total_amount = 0;\n      for (const elem of portfolio_summed) {\n        total_amount = total_amount + elem.amount;\n      }\n\n      //calculate the percentage of each element in the portfolio\n      for (let elem of portfolio_summed) {\n        elem.percentage = (elem.amount / total_amount) * 100;\n      }\n\n      //sort the portfolio-wise values first by percentage then by the symbol name alphabetically\n      let portfolio_sorted = _.orderBy(\n        portfolio_summed,\n        [\"percentage\", \"symbol\"],\n        [\"desc\", \"desc\"]\n      );\n\n      //get arrays of values to be sent as props to highcharts\n      let symbols: string[] = [...portfolio_sorted.map(x => x.symbol)];\n      let percentages: number[] = [...portfolio_sorted.map(x => x.percentage)] as number[];\n      let amounts: number[] = [...portfolio_sorted.map(x => x.amount)];\n      let quantities: number[] = [...portfolio_sorted.map(x => x.qty)];\n\n\n      // console.log(\"data fetcher called!\");\n      //update the state with raw incoming data and arrays describing the portfolio\n      this.setState(\n        {\n          trades_data: trades_data,\n          symbols: symbols,\n          percentages: percentages,\n          amounts: amounts,\n          quantities: quantities\n        }\n      );\n    });\n  }\n\n\n  render() {\n    // TODO: THIS CONIDITION CHECK IS A TEMPORARY SOLUTION TO STATE INITIALIZATION PROBLEM\n    if (this.state.trades_data.length !== 1) {\n      return (\n        <BrowserRouter>\n          <div className=\"App\">\n            <h1><span id=\"brand_text\">PORTFOLIO</span></h1>\n\n            <Route\n              path=\"/\"\n              exact\n              render={routeProps => (\n                <PieChart\n                  {...routeProps}\n                  symbols={this.state.symbols}\n                  percentages={this.state.percentages}\n                  amounts={this.state.amounts}\n                  quantities={this.state.quantities}\n                />\n              )}\n            />\n            <Route\n              path=\"/addTrade\"\n              exact\n              render={routeProps => (\n                <NewTradeForm {...routeProps} symbols={this.state.symbols} dataFetcher={this.fetchData}/>\n              )}\n            />\n            <Route\n              path=\"/detail/:symbol\"\n              exact\n              render={routeProps => (\n                <SymbolGrid {...routeProps} trades={this.state.trades_data} />\n              )}\n            />\n          </div>\n        </BrowserRouter>\n      );\n    }\n    else{\n      return(\n      <div className=\"spinner\">\n        <ClassicSpinner \n          size={40}\n          color=\"#686769\"\n          loading={true}\n        />\n      </div>    \n      )\n    }\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}